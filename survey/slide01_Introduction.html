{% block styles %}
    <link rel="stylesheet" href="{{ static 'main.css' }}">
{% endblock %}

{% block content %}

<h2>Perceptions of Political Opinions / Wahrnehmung politischer Meinungen</h2>
<p>Welcome to our survey! / Willkommen zu unserer Umfrage!
</p>
<br>


<!-- Language Selection -->
<div class="language-section">
    <div class="card">
        <div class="form-group">
            <label class="form-label" data-i18n="selectLanguage">Please select your preferred language / Bitte w√§hlen Sie Ihre bevorzugte Sprache:</label>
            <div class="option-cards" data-field="language">
                <label class="option-card">
                    <input type="radio" name="language" value="en"> English
                </label>
                <label class="option-card">
                    <input type="radio" name="language" value="de"> Deutsch
                </label>
            </div>
        </div>
    </div>
</div>

<br>

<!-- Consent Section -->
<div class="consent-section" id="consent-section" style="display: none;">
    <div class="card">
        <div class="form-group">
            <h3 data-i18n="consentTitle"></h3>
            <p data-i18n="dearParticipant"></p>
            <p data-i18n="consentText"></p>

            <p><strong data-i18n="purposeTitle"></strong></p>
            <p data-i18n="purposeBody"></p>
            <p data-i18n="purposeBody2"></p>
            <p data-i18n="purposeBody3"></p>
            
            <p><strong data-i18n="eligibility"></strong></p>
            <p data-i18n="eligibilityBody"></p>
            

            <p><strong data-i18n="procedureTitle"></strong></p>
            <p data-i18n="procedureBody"></p>
            <ul>
                <li>
                    <p data-i18n="procedureBody1"></p>
                </li>
                <li>
                    <p data-i18n="procedureBody2"></p>
                </li>
                <li>
                    <p data-i18n="procedureBody3"></p>
                </li>
                <li>
                    <p data-i18n="procedureBody4"></p>
                </li>
                <li>
                    <p data-i18n="procedureBody5"></p>
                </li>
                <li>
                    <p data-i18n="procedureBody6"></p>
                </li>
            </ul>
    

            <p><strong data-i18n="paymentTitle"></strong></p>
            <p data-i18n="paymentBody"></p><p><strong data-i18n="paymentMoney"></strong></p>

            <p><strong data-i18n="withdrawal"></strong></p>
            <p data-i18n="withdrawalInfo"></p>
            <p style="margin-top:-1em">üìß <a href='mailto:collectivemindslab@csh.ac.at'>collectivemindslab@csh.ac.at</a></p>
            <p data-i18n="studyCoordinators"></p>

            <p><strong data-i18n="dataUsageTitle"></strong></p>
            <ul>
                <li><p data-i18n="dataUsage1"></p></li>
                <li><p data-i18n="dataUsage2"></p></li>
                <li><p data-i18n="dataUsage3"></p></li>
                <li><p data-i18n="dataUsage4"></p></li>
            </ul>

            <p><strong data-i18n="questionsTitle"></strong></p>
            <p data-i18n="questionsBody"></p><p style="margin-top:-1em">üìß <a href='mailto:collectivemindslab@csh.ac.at'>collectivemindslab@csh.ac.at</a></p>

            <p data-i18n="ethicsReview"></p>
{% comment %} 
            <div class="instructions">
                <p data-i18n="consentDisclaimer"></p>
            </div> {% endcomment %}
            
            <div class="instructions" style="margin: 10px 0; padding: 10px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
                <p data-i18n="consentDecl"></p>
            </div>

                <div class="option-cards" data-field="consent">
                    <label class="option-card">
                        <input type="radio" name="consent" value="1">
                        <span data-i18n="consentYes"></span>
                    </label>
                    <label class="option-card">
                        <input type="radio" name="consent" value="0">
                        <span data-i18n="consentNo"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>
</div>

<br>

<div style="display: flex; justify-content: space-between; align-items: center;">
    {{ next_button }}
    <div id="pagedispl"></div>
</div>



<script>
const translations = {
    en: {
        welcomeTitle: "Welcome to our survey on the perception of political opinions!",
        selectLanguage: "Please select your preferred language:",
        consentTitle: "Participant Consent Form",
        dearParticipant: "Dear participant,",
        consentText: "Thank you for considering participation in our study. Please read the following information carefully before giving your consent.",
        purposeTitle: "Purpose of the Study",
        purposeBody: "This study explores how people perceive and interpret political differences and similarities.",
        purposeBody2:"There are no right or wrong answers. We are interested in your personal perceptions and judgments.",
        purposeBody3: "Our goal is to understand whether people perceive opinions and political polarisation in similar ways, or whether perceptions vary systematically across individuals.",
        benefitsBody1: "The findings from this project will provide information on whether people perceive opinions and polarisation in society similarly or whether there are systematic differences in perception.",
        eligibility: "Eligibility:", 
        eligibilityBody: "You are eligible to take part in this study if you are at least 18 years old and currently reside in Germany.",
        procedureTitle: "Study Procedure",
        procedureBody: "The study will take approximately 30 minutes and consists of the following steps:", 
        procedureBody1: "Answer a few questions about your own political views.", 
        procedureBody2: "Name six people you know well and estimate their political views.", 
        procedureBody3: "Estimate the political views of typical voters of the Greens, the AfD, the Left, and the FDP.", 
        procedureBody4: "Place the individuals on a political map. ", 
        procedureBody5: "Indicate how politically similar or different you think each pair of individuals is.",
        procedureBody6: "Complete a few brief questions about your perceptions of political polarisation and some background questions about yourself.",
        paymentTitle: "Compensation:",
        paymentBody: "You will be compensated for the duration of the study through Prolific according to standard hourly rates:",
        paymentMoney: "5 GBP for 30 minutes.",
        withdrawal: "Voluntary Participation and Withdrawal",
        withdrawalInfo: "Your participation in this research study is voluntary. You may refuse to participate or stop at any time without penalty. If you complete the study but later wish to have your data removed, please contact us within 30 days at:",
        studyCoordinators: "(Study coordinators: Mirta Galesic and Peter Steiglechner)",
        dataUsageTitle: "Data Privacy and Usage",
        dataUsage1: "Any identifying information (e.g., your Prolific ID) will be kept strictly confidential and never shared without your explicit permission.",
        dataUsage2: "Identifying data is stored separately from your survey responses.",
        dataUsage3: "Your anonymised data may be shared in an open-access scientific repository for non-commercial research purposes.",
        dataUsage4: "Your data will never be used in ways incompatible with the aims of this study.",
        questionsTitle: "Questions or Concerns?",
        questionsBody: "If you have any questions, feel free to contact the study coordinators at:",
        ethicsReview: "This study has been reviewed by the University of New Mexico Institutional Review Board (IRB) IRB-ID 2501179238A001.",
        consentDecl: "I have read the information provided above. By clicking 'I give consent' I indicate my voluntary agreement to participate in this research study.",
        consentYes: "I give consent.",
        consentNo: "I do not give consent.",
        nextBtn: "Next",
        pageText: "Page 1/23"
    },
    de: {
  "welcomeTitle": "Willkommen zu unserer Umfrage √ºber die Wahrnehmung politischer Meinungen!",
  "selectLanguage": "Bitte w√§hlen Sie Ihre bevorzugte Sprache:",
  "consentTitle": "Einverst√§ndniserkl√§rung der Teilnehmenden",
  "dearParticipant": "Liebe Teilnehmerin, lieber Teilnehmer,",
  "consentText": "Vielen Dank f√ºr Ihr Interesse an unserer Studie. Bitte lesen Sie die folgenden Informationen sorgf√§ltig durch, bevor Sie Ihre Einwilligung geben.",
  "purposeTitle": "Zweck der Studie",
  "purposeBody": "Diese Studie untersucht, wie Menschen politische Unterschiede und Gemeinsamkeiten wahrnehmen und interpretieren.",
  "purposeBody2": "Es gibt keine richtigen oder falschen Antworten ‚Äì wir interessieren uns f√ºr Ihre pers√∂nliche Wahrnehmung und Einsch√§tzung.",
  "purposeBody3": "Unser Ziel ist es zu verstehen, ob Menschen politische Meinungen und Polarisierung √§hnlich wahrnehmen oder ob es systematische Unterschiede in der Wahrnehmung gibt.",
  "benefitsBody1": "Die Ergebnisse dieses Projekts sollen aufzeigen, ob Menschen politische Meinungen und gesellschaftliche Polarisierung √§hnlich oder unterschiedlich wahrnehmen.",
  "eligibility": "Teilnahmeberechtigung:",
  "eligibilityBody": "Sie k√∂nnen an dieser Studie teilnehmen, wenn Sie mindestens 18 Jahre alt sind und derzeit in Deutschland leben.",
  "procedureTitle": "Ablauf der Studie",
  "procedureBody": "Die Teilnahme dauert etwa 30 Minuten und beinhaltet folgende Schritte:",
"procedureBody1": "Sie beantworten zun√§chst einige Fragen zu Ihren eigenen politischen Einstellungen.",
"procedureBody2": "Dann nennen Sie sechs Personen, die Sie gut kennen, und sch√§tzen deren politische Ansichten ein.",
"procedureBody3": "Anschlie√üend sch√§tzen Sie ein, wie typische W√§hler oder W√§hlerinnen der Gr√ºnen, AfD, Linken und FDP politisch eingestellt sind.",
"procedureBody4": "Sie verorten alle genannten Personen auf einer politischen Karte ein.",
"procedureBody5": "Sie geben an, wie politisch √§hnlich oder unterschiedlich Sie die verschiedenen Personen zueinander einsch√§tzen.",
  "procedureBody6": "Zum Schluss beantworten Sie einige kurze Fragen zu Ihrer Wahrnehmung von Polarisierung sowie zu Ihrer Person.",
  "paymentTitle": "Verg√ºtung:",
  "paymentBody": "Sie erhalten f√ºr Ihre Teilnahme eine Verg√ºtung √ºber Prolific gem√§√ü den √ºblichen Stundens√§tzen:",
  "paymentMoney": "5 GBP f√ºr 30 Minuten.",
  "withdrawal": "Freiwillige Teilnahme und R√ºcktritt",
  "withdrawalInfo": "Die Teilnahme an dieser Studie ist freiwillig. Sie k√∂nnen die Teilnahme jederzeit ohne Angabe von Gr√ºnden und ohne Nachteile abbrechen. Wenn Sie die Studie abgeschlossen haben, Ihre Daten aber sp√§ter l√∂schen lassen m√∂chten, kontaktieren Sie uns bitte innerhalb von 30 Tagen unter:",
  "studyCoordinators": "(Studienleitung: Mirta Galesic und Peter Steiglechner)",
  "dataUsageTitle": "Datenschutz und Verwendung der Daten",
  "dataUsage1": "Alle identifizierenden Informationen (z.B. Ihre Prolific-ID) werden streng vertraulich behandelt und nur mit Ihrer ausdr√ºcklichen Zustimmung weitergegeben.",
  "dataUsage2": "Identifizierende Daten werden getrennt von Ihren Umfrageantworten gespeichert.",
  "dataUsage3": "Ihre anonymisierten Daten k√∂nnen in einem frei zug√§nglichen wissenschaftlichen Repository f√ºr nicht-kommerzielle Forschungszwecke ver√∂ffentlicht werden.",
  "dataUsage4": "Ihre Daten werden niemals f√ºr Zwecke verwendet, die nicht mit den Zielen dieser Studie vereinbar sind.",
  "questionsTitle": "Fragen oder Bedenken?",
  "questionsBody": "Wenn Sie Fragen haben, wenden Sie sich bitte an die Studienleitung unter:",
  "ethicsReview": "Diese Studie wurde durch das Institutional Review Board (IRB) der University of New Mexico gepr√ºft. IRB-ID: 2501179238A001.",
  "consentDecl": "Ich habe die oben stehenden Informationen gelesen. Mit einem Klick auf 'Ich gebe mein Einverst√§ndnis' erkl√§re ich meine freiwillige Einverst√§ndnis zur Teilnahme an dieser Studie.",
  "consentYes": "Ich gebe mein Einverst√§ndnis.",
  "consentNo": "Ich gebe mein Einverst√§ndnis nicht.",
  "nextBtn": "Weiter",
  "pageText": "Seite 1/23"
}
};

    // Initially hide oTree's next button
    document.addEventListener("DOMContentLoaded", function () {
        const nextButton = document.querySelector('button[type="submit"]');

        // Handle language + consent selection
        document.querySelectorAll('.option-cards').forEach(group => {
            const field = group.dataset.field;
            group.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    // Remove all selected
                    group.querySelectorAll('.option-card').forEach(card => card.classList.remove('selected'));
                    radio.closest('.option-card').classList.add('selected');

                    if (field === 'language') {
                        document.getElementById('consent-section').style.display = 'block';
                        updateLanguage(radio.value);
                    }
                });
            });
        });
    });



        function updateLanguage(lang) {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
        }

        // Option card selection handling
        document.querySelectorAll('.option-cards').forEach(group => {
            const field = group.dataset.field;
            group.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    // Remove all selected
                    group.querySelectorAll('.option-card').forEach(card => card.classList.remove('selected'));
                    // Add selected class to the parent
                    radio.closest('.option-card').classList.add('selected');

                    // Handle language change
                    if (field === 'language') {
                        document.getElementById('consent-section').style.display = 'block';
                        updateLanguage(radio.value);
                    }
                });
            });
        });
</script>
{% endblock %}